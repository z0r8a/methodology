# تعریف
آسیب‌پذیری Session Fixation (فیکس شدن نشست) به نوعی از ضعف امنیتی در برنامه‌های وب اطلاق می‌شود که در آن یک مهاجم می‌تواند نشست (Session) کاربر را پیش از ورود او به سیستم، به یک نشست خاص و مشخص تنظیم کند. به این ترتیب، مهاجم قادر خواهد بود تا نشست ایجاد شده را به کاربر تحمیل کرده و در نتیجه دسترسی غیرمجاز به داده‌ها و اطلاعات خصوصی کاربر پیدا کند.

در این نوع حمله، مهاجم ممکن است با ارسال یک شناسه نشست (Session ID) خاص به کاربر، او را به استفاده از آن شناسه هدایت کند. وقتی کاربر وارد سیستم می‌شود، شناسه نشست مهاجم فعال خواهد شد و مهاجم قادر است به حساب کاربر دسترسی پیدا کند، حتی اگر کاربر به درستی وارد حساب خود شده باشد.

# روش ارزیابی
## 1. تست ارسال شناسه نشست از پیش تعیین‌شده (Predefined Session ID)
### هدف: بررسی اینکه آیا شناسه نشست از پیش تعیین‌شده می‌تواند توسط مهاجم به کاربر تحمیل شود.
### روش:
یک شناسه نشست معتبر (یا غیرمعتبر) را از طریق URL، کوکی‌ها، یا پارامترهای درخواست به کاربر ارسال کنید.
از کاربر بخواهید تا وارد سیستم شود یا جلسه جدیدی ایجاد کند.
بررسی کنید که آیا شناسه نشست از پیش تعیین‌شده هنوز فعال است و مهاجم می‌تواند با استفاده از آن شناسه نشست وارد حساب کاربری کاربر شود.
اگر شناسه نشست پیش از ورود کاربر فعال باقی بماند و مهاجم بتواند به حساب کاربری دسترسی پیدا کند، آسیب‌پذیری Session Fixation وجود دارد.

2. تست ریست شناسه نشست پس از ورود به سیستم
هدف: بررسی اینکه آیا پس از ورود به سیستم شناسه نشست تغییر می‌کند یا خیر.
روش:
وارد سیستم شوید و شناسه نشست موجود را بررسی کنید.
پس از ورود به سیستم، شناسه نشست باید تغییر کند.
اگر شناسه نشست تغییر نکند و مهاجم قادر به استفاده از همان شناسه نشست برای دسترسی به حساب کاربری شود، آسیب‌پذیری Session Fixation وجود دارد.
در صورت تغییر شناسه نشست، بررسی کنید که آیا نشانه‌های امنیتی دیگری مانند تغییر در کوکی‌ها یا تنظیمات مرورگر نیز مشاهده می‌شود.

4. تست شناسه نشست در URL (استفاده از پارامترهای URL)
هدف: بررسی اینکه آیا شناسه نشست از طریق URL منتقل می‌شود یا خیر.
روش:
بررسی کنید که آیا شناسه نشست در URL (مثل http://example.com?sessionid=xyz123) ارسال می‌شود.
سعی کنید شناسه نشست را در URL تغییر دهید و بررسی کنید که آیا این تغییرات به نشست‌های جدید منجر می‌شود یا خیر.
اگر تغییر شناسه نشست از طریق URL تأثیری نداشته باشد و سیستم شناسه نشست جدیدی تولید نکند، آسیب‌پذیری Session Fixation وجود دارد.

6. تست نگهداری نشست پس از خروج از سیستم
هدف: بررسی اینکه آیا پس از خروج از سیستم، شناسه نشست همچنان معتبر باقی می‌ماند.
روش:
وارد سیستم شوید و شناسه نشست را بررسی کنید.
از سیستم خارج شوید (logout).
بررسی کنید که آیا شناسه نشست قبلی هنوز معتبر است و کاربر می‌تواند با استفاده از همان شناسه نشست وارد سیستم شود.
اگر شناسه نشست بعد از خروج معتبر باقی بماند، احتمال وجود آسیب‌پذیری Session Fixation وجود دارد.

8. تست استفاده از شناسه نشست در کوکی‌ها
هدف: بررسی امنیت و اعتبار شناسه نشست ذخیره‌شده در کوکی‌ها.
روش:
شناسه نشست را در کوکی مرورگر بررسی کنید.
سعی کنید شناسه نشست را به صورت دستی تغییر دهید و وارد سیستم شوید.
بررسی کنید که آیا تغییر شناسه نشست در کوکی‌ها باعث دسترسی به حساب کاربری می‌شود یا خیر.
اگر سیستم اجازه دسترسی با شناسه نشست تغییر داده‌شده را بدهد، آسیب‌پذیری Session Fixation وجود دارد.
9. تست از نظر تغییرات در سیاست‌های امنیتی HTTP (HTTP Security Headers)
هدف: بررسی اینکه آیا سیاست‌های امنیتی برای جلوگیری از تغییر شناسه نشست فعال هستند یا خیر.
روش:
بررسی کنید که آیا سیاست‌های امنیتی مانند HttpOnly, Secure, و SameSite برای کوکی‌های نشست اعمال شده‌اند.
کوکی‌هایی که شناسه نشست را نگهداری می‌کنند باید دارای ویژگی‌های Secure (برای انتقال فقط از طریق HTTPS) و HttpOnly (برای جلوگیری از دسترسی جاوااسکریپت) باشند.
اگر این سیاست‌ها اعمال نشده باشند، آسیب‌پذیری Session Fixation می‌تواند راحت‌تر مورد بهره‌برداری قرار گیرد.
